<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>剧情共创空间 - iOS光学边缘反光版</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- 配置Tailwind -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            warm: {
              50: '#FFF8E6',
              100: '#FFEDCC',
              200: '#FFE2B3',
              300: '#FFD799',
              400: '#FFCC80',
              500: '#FFB74D',
              600: '#FFA726',
              700: '#FB8C00',
              800: '#F57C00',
            },
            text: '#5D4037'
          },
          fontFamily: {
            'serif': ['Noto Serif SC', 'serif']
          }
        },
      }
    }
  </script>
  
  <style type="text/css">
    body {
      font-family: 'Noto Serif SC', serif;
      background: linear-gradient(to bottom, #FFEDCC, #FFF8E6);
      color: #5D4037;
      min-height: 100vh;
    }
    
    /* iOS风格边缘镭射反光效果 */
    .edge-laser-glow {
      position: relative;
      overflow: hidden;
      border-radius: 16px;
    }
    
    .edge-laser-glow::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 18px;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.8) 0%,
        rgba(255, 255, 255, 0.5) 40%,
        rgba(255, 255, 255, 0) 70%,
        rgba(255, 255, 255, 0.3) 100%
      );
      background-size: 300% 300%;
      opacity: 0.8;
      z-index: -1;
      pointer-events: none;
      animation: laser-sweep 8s infinite linear;
    }
    
    @keyframes laser-sweep {
      0% {
        background-position: 0% 0%;
      }
      25% {
        background-position: 100% 30%;
      }
      50% {
        background-position: 80% 80%;
      }
      75% {
        background-position: 20% 100%;
      }
      100% {
        background-position: 0% 0%;
      }
    }
    
    /* 按钮镭射效果 */
    .btn-laser {
      position: relative;
      overflow: hidden;
    }
    
    .btn-laser::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.7) 0%,
        rgba(255, 255, 255, 0.3) 50%,
        rgba(255, 255, 255, 0.7) 100%
      );
      opacity: 0.6;
      mix-blend-mode: overlay;
      animation: btn-laser 2s infinite linear;
      transform: translateX(-100%) skewX(-15deg);
    }
    
    @keyframes btn-laser {
      100% {
        transform: translateX(100%) skewX(-15deg);
      }
    }
    
    /* 卡片样式 */
    .module-card {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 16px;
      padding: 20px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      backdrop-filter: blur(8px);
      position: relative;
      overflow: hidden;
    }
    
    .module-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    }
    
    /* 玻璃效果 */
    .glass-effect {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }
    
    /* 动画效果 */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-in-out forwards;
    }
    
    .slide-up {
      animation: slideUp 0.6s ease-out forwards;
    }
    
    /* 波纹效果 */
    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      transform: scale(0);
      animation: ripple 0.6s linear;
    }
    
    @keyframes ripple {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }
    
    /* 微光效果 */
    .light-refraction::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(
        circle at 70% 20%,
        rgba(255, 255, 255, 0.4) 0%,
        transparent 70%
      );
      opacity: 0.3;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }
    
    .light-refraction:hover::before {
      opacity: 0.6;
    }
    
    /* 浮动效果 */
    .floating {
      animation: floating 4s ease-in-out infinite;
    }
    
    @keyframes floating {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(-10px) rotate(2deg); }
      50% { transform: translateY(0) rotate(0deg); }
      75% { transform: translateY(-8px) rotate(-2deg); }
    }
    
    /* 标题样式 */
    .section-title {
      font-size: clamp(1.5rem, 3vw, 2rem);
      font-weight: 700;
      color: #5D4037;
      margin-bottom: 24px;
      padding-bottom: 8px;
      border-bottom: 2px solid #FFEDCC;
      position: relative;
    }
    
    .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, #FFB74D, #FB8C00);
      border-radius: 2px;
    }
    
    /* 按钮样式 */
    .btn-primary {
      background: linear-gradient(135deg, #FFB74D, #FB8C00);
      color: white;
      padding: 10px 20px;
      border-radius: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      border: none;
      cursor: pointer;
    }
    
    .btn-primary:hover {
      background: linear-gradient(135deg, #FFA726, #F57C00);
      box-shadow: 0 6px 15px rgba(251, 140, 0, 0.3);
    }
    
    .btn-secondary {
      background: rgba(255, 237, 204, 0.7);
      color: #5D4037;
      padding: 10px 20px;
      border-radius: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
    }
    
    .btn-secondary:hover {
      background: rgba(255, 237, 204, 1);
      box-shadow: 0 4px 12px rgba(93, 64, 55, 0.1);
    }
    
    /* 开机动画 */
    #splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #FFB74D, #FB8C00);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      animation: splash 1.8s ease-out forwards;
    }
    
    @keyframes splash {
      0% { opacity: 0; transform: scale(0.8); filter: blur(20px); }
      50% { opacity: 1; transform: scale(1.05); filter: blur(0); }
      100% { opacity: 0; transform: scale(1.2); filter: blur(10px); }
    }
    
    /* 通知样式 */
    #toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 183, 77, 0.9);
      color: white;
      padding: 12px 24px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      z-index: 50;
      opacity: 0;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      backdrop-filter: blur(10px);
    }
    
    /* 管理员卡片 */
    .admin-card {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform-origin: center;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
    }
    
    .admin-card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 20px 40px rgba(0,0,0,0.12);
    }
  </style>
</head>

<body class="min-h-screen">
  <!-- 开机动画 -->
  <div id="splash-screen">
    <div class="text-center">
      <div class="text-5xl text-white font-bold mb-4 floating">剧情共创空间</div>
      <div class="text-white text-xl mb-6">iOS光学边缘反光效果</div>
      <div class="relative w-64 h-2 bg-white/30 rounded-full mx-auto overflow-hidden">
        <div id="loading-bar" class="absolute top-0 left-0 h-full bg-white rounded-full" style="width: 0%"></div>
      </div>
    </div>
  </div>
  
  <!-- 顶部通知 -->
  <div id="toast" class="opacity-0">
    <i class="fa fa-check-circle"></i>
    <span id="toast-message">操作成功</span>
    <button onclick="hideToast()" class="ml-2 text-white/80 hover:text-white">
      <i class="fa fa-times"></i>
    </button>
  </div>

  <!-- 导航栏 -->
  <header class="glass-effect sticky top-0 z-40 edge-laser-glow">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center gap-2">
        <div class="w-9 h-9 flex items-center justify-center bg-gradient-to-br from-[#FFB74D] to-[#FB8C00] rounded-lg text-white">
          <i class="fa fa-pencil-square-o text-xl"></i>
        </div>
        <h1 class="text-xl font-bold text-[#5D4037]">剧情共创空间</h1>
      </div>
      
      <div class="flex items-center gap-3">
        <div id="user-info" class="hidden items-center gap-2">
          <img id="user-avatar" src="https://picsum.photos/id/64/100/100" class="w-8 h-8 rounded-full object-cover border-2 border-white">
          <span id="username-display" class="text-sm font-medium text-[#5D4037]"></span>
          <button onclick="logout()" class="text-sm text-[#5D4037]/70 hover:text-[#FB8C00] ml-2">
            <i class="fa fa-sign-out"></i>
          </button>
        </div>
        <button id="login-btn" class="btn-secondary text-sm hidden sm:block">
          <i class="fa fa-user mr-1"></i> 登录/注册
        </button>
        <button id="mobile-menu-btn" class="sm:hidden text-[#5D4037]">
          <i class="fa fa-bars text-xl"></i>
        </button>
      </div>
    </div>
    
    <!-- 移动端菜单 -->
    <div id="mobile-menu" class="sm:hidden hidden bg-white border-t fade-in">
      <div class="container mx-auto px-4 py-2 flex flex-col gap-2">
        <button id="mobile-login-btn" class="py-2 text-left hover:bg-[#FFF8E6] px-2 rounded">
          <i class="fa fa-user mr-2 text-[#FB8C00]"></i>登录/注册
        </button>
        <button class="py-2 text-left hover:bg-[#FFF8E6] px-2 rounded">
          <i class="fa fa-book mr-2 text-[#FB8C00]"></i>我的项目
        </button>
        <button class="py-2 text-left hover:bg-[#FFF8E6] px-2 rounded">
          <i class="fa fa-history mr-2 text-[#FB8C00]"></i>我的投票
        </button>
        <button class="py-2 text-left hover:bg-[#FFF8E6] px-2 rounded">
          <i class="fa fa-cog mr-2 text-[#FB8C00]"></i>设置
        </button>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-6">
    <!-- 欢迎区域 -->
    <div class="glass-effect rounded-xl p-6 mb-6 text-center light-refraction edge-laser-glow">
      <h2 class="text-xl font-bold mb-2">欢迎来到剧情共创空间</h2>
      <p class="text-sm text-[#5D4037]/80">在这里，每个人都可以参与故事创作，投票决定剧情走向，一起打造精彩故事</p>
    </div>

    <!-- 公告栏 -->
    <div class="glass-effect rounded-xl p-4 mb-6 edge-laser-glow">
      <div class="flex items-center gap-2 mb-2">
        <i class="fa fa-bullhorn text-[#FB8C00] text-lg"></i>
        <h3 class="font-bold">平台公告</h3>
      </div>
      <div class="text-sm text-[#5D4037]/80">
        <p class="mb-1"><i class="fa fa-star text-[#FFB74D] mr-1"></i> 共创平台用户突破5000人，感谢大家的支持！</p>
        <p class="mb-1"><i class="fa fa-star text-[#FFB74D] mr-1"></i> 《星际迷航：未知边境》投票即将截止，抓紧时间参与！</p>
        <p><i class="fa fa-star text-[#FFB74D] mr-1"></i> 新功能上线！现在可以回复评论啦～</p>
      </div>
    </div>

    <!-- 主要内容区域 -->
    <div id="main-content">
      <!-- 1. 进行中的项目模块 -->
      <section class="mb-10">
        <h2 class="section-title">进行中的共创项目</h2>
        
        <!-- 项目1 -->
        <div id="project1" class="module-card mb-6 slide-up edge-laser-glow">
          <div class="flex flex-col sm:flex-row gap-4">
            <div class="sm:w-1/3">
              <img src="https://picsum.photos/id/24/400/300" alt="科幻冒险故事" class="w-full h-40 object-cover rounded-lg">
            </div>
            <div class="sm:w-2/3">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-bold text-lg">《星际迷航：未知边境》</h3>
                <span class="bg-[#FFEDCC] text-[#FB8C00] text-xs px-2 py-1 rounded-full">动画剧情</span>
              </div>
              <p class="text-sm text-[#5D4037]/80 mb-3">
                星际联邦"探索者号"飞船在银河系边缘遭遇未知引力场，通讯系统开始失灵，船员们必须在72小时内做出关键选择：是派出登陆小队探索神秘星球，还是启动紧急程序撤离该区域？
              </p>
              <div class="flex flex-wrap gap-3 mb-3 text-xs">
                <span class="bg-[#FFF8E6] px-2 py-1 rounded-full"><i class="fa fa-tag mr-1"></i>科幻</span>
                <span class="bg-[#FFF8E6] px-2 py-1 rounded-full"><i class="fa fa-tag mr-1"></i>冒险</span>
                <span class="bg-[#FFF8E6] px-2 py-1 rounded-full"><i class="fa fa-tag mr-1"></i>太空</span>
              </div>
              <div class="flex justify-between items-center">
                <div class="flex items-center text-sm text-[#5D4037]/70">
                  <i class="fa fa-users mr-1"></i> <span id="participants1">248</span>人参与
                  <span class="mx-2">|</span>
                  <i class="fa fa-clock-o mr-1"></i> <span id="countdown1">剩余3天</span>
                </div>
                <button class="btn-primary text-sm join-project btn-laser" data-project="星际迷航：未知边境">
                  参与共创
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 项目2 -->
        <div id="project2" class="module-card slide-up edge-laser-glow">
          <div class="flex flex-col sm:flex-row gap-4">
            <div class="sm:w-1/3">
              <img src="https://picsum.photos/id/119/400/300" alt="奇幻小说" class="w-full h-40 object-cover rounded-lg">
            </div>
            <div class="sm:w-2/3">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-bold text-lg">《魔法森林的秘密》</h3>
                <span class="bg-[#FFEDCC] text-[#FB8C00] text-xs px-2 py-1 rounded-full">小说剧本</span>
              </div>
              <p class="text-sm text-[#5D4037]/80 mb-3">
                年轻的主角艾莉在祖母留下的旧书里发现了一张魔法地图，指引她前往传说中的魔法森林。在森林入口，她遇到了守护精灵，精灵告诉她必须选择一种魔法作为入门：治愈系魔法或元素攻击魔法。
              </p>
              <div class="flex flex-wrap gap-3 mb-3 text-xs">
                <span class="bg-[#FFF8E6] px-2 py-1 rounded-full"><i class="fa fa-tag mr-1"></i>奇幻</span>
                <span class="bg-[#FFF8E6] px-2 py-1 rounded-full"><i class="fa fa-tag mr-1"></i>魔法</span>
                <span class="bg-[#FFF8E6] px-2 py-1 rounded-full"><i class="fa fa-tag mr-1"></i>成长</span>
              </div>
              <div class="flex justify-between items-center">
                <div class="flex items-center text-sm text-[#5D4037]/70">
                  <i class="fa fa-users mr-1"></i> <span id="participants2">186</span>人参与
                  <span class="mx-2">|</span>
                  <i class="fa fa-clock-o mr-1"></i> <span id="countdown2">剩余5天</span>
                </div>
                <button class="btn-primary text-sm join-project btn-laser" data-project="魔法森林的秘密">
                  参与共创
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 2. 剧情投票模块 -->
      <section class="mb-10">
        <h2 class="section-title">剧情走向投票</h2>
        
        <div class="module-card slide-up edge-laser-glow">
          <h3 class="font-bold text-lg mb-4">《星际迷航：未知边境》- 下一步剧情选择</h3>
          <p class="text-sm text-[#5D4037]/80 mb-4">
            请为"探索者号"飞船的下一步行动投票，投票结果将决定故事的发展方向，目前已有<span id="total-voters">248</span>人参与投票。
          </p>
          
          <div class="space-y-4 mb-5">
            <!-- 选项1 -->
            <div class="border border-[#FFEDCC] rounded-lg p-3 hover:bg-[#FFF8E6] transition-colors">
              <div class="flex justify-between items-center mb-2">
                <label class="font-medium cursor-pointer flex items-center gap-2">
                  <input type="radio" name="plot-choice" value="option1" class="accent-[#FB8C00]">
                  探索神秘星球
                </label>
                <span class="text-sm text-[#5D4037]/70"><span id="option1-percent">68</span>% (<span id="option1-votes">169</span>票)</span>
              </div>
              <p class="text-sm text-[#5D4037]/80 pl-6">
                派出由舰长亲自带领的登陆小队，探索未知星球表面，寻找引力场来源。这可能意味着发现先进的外星文明，或者遭遇危险的未知生物，但也可能找到修复飞船的关键技术。
              </p>
              <div class="w-full bg-[#FFEDCC] rounded-full h-2 mt-2 pl-6">
                <div class="bg-gradient-to-r from-[#FFB74D] to-[#FB8C00] h-2 rounded-full" id="option1-bar" style="width: 68%"></div>
              </div>
            </div>
            
            <!-- 选项2 -->
            <div class="border border-[#FFEDCC] rounded-lg p-3 hover:bg-[#FFF8E6] transition-colors">
              <div class="flex justify-between items-center mb-2">
                <label class="font-medium cursor-pointer flex items-center gap-2">
                  <input type="radio" name="plot-choice" value="option2" class="accent-[#FB8C00]">
                  紧急撤离
                </label>
                <span class="text-sm text-[#5D4037]/70"><span id="option2-percent">32</span>% (<span id="option2-votes">79</span>票)</span>
              </div>
              <p class="text-sm text-[#5D4037]/80 pl-6">
                启动紧急脱离程序，消耗大量燃料摆脱引力场，确保船员安全。这将放弃当前探索机会，但可能导致后续燃料不足，需要寻找就近的星际空间站补充能源。
              </p>
              <div class="w-full bg-[#FFEDCC] rounded-full h-2 mt-2 pl-6">
                <div class="bg-gradient-to-r from-[#FFB74D] to-[#FB8C00] h-2 rounded-full" id="option2-bar" style="width: 32%"></div>
              </div>
            </div>
          </div>
          
          <button id="vote-btn" class="btn-primary w-full btn-laser">
            <i class="fa fa-check mr-1"></i> 提交我的投票
          </button>
        </div>
      </section>
    </div>
  </main>

  <footer class="bg-white mt-10 py-6 border-t border-[#FFEDCC]">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center gap-2 mb-4 md:mb-0">
          <i class="fa fa-pencil-square-o text-[#FB8C00] text-xl"></i>
          <span class="font-bold text-[#5D4037]">剧情共创空间</span>
        </div>
        
        <div class="flex gap-6 mb-4 md:mb-0">
          <a href="#" class="text-sm text-[#5D4037]/70 hover:text-[#FB8C00]">关于我们</a>
          <a href="#" class="text-sm text-[#5D4037]/70 hover:text-[#FB8C00]">使用规则</a>
          <a href="#" class="text-sm text-[#5D4037]/70 hover:text-[#FB8C00]">帮助中心</a>
        </div>
        
        <div class="flex gap-4">
          <a href="#" class="w-8 h-8 rounded-full bg-[#FFEDCC] flex items-center justify-center text-[#FB8C00] hover:bg-[#FFD799] transition-colors">
            <i class="fa fa-weixin"></i>
          </a>
          <a href="#" class="w-8 h-8 rounded-full bg-[#FFEDCC] flex items-center justify-center text-[#FB8C00] hover:bg-[#FFD799] transition-colors">
            <i class="fa fa-weibo"></i>
          </a>
          <a href="#" class="w-8 h-8 rounded-full bg-[#FFEDCC] flex items-center justify-center text-[#FB8C00] hover:bg-[#FFD799] transition-colors">
            <i class="fa fa-qq"></i>
          </a>
        </div>
      </div>
      
      <div class="text-center text-sm text-[#5D4037]/60 mt-6">
        © 2023 剧情共创空间 - iOS光学边缘反光效果展示
      </div>
    </div>
  </footer>

  <!-- 登录模态框 -->
  <div id="login-modal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-xl p-5 w-full max-w-sm fade-in glass-effect edge-laser-glow">
      <div class="flex justify-between items-center mb-4">
        <h3 class="font-bold text-lg">账号登录</h3>
        <button id="close-login" class="text-[#5D4037]/60 hover:text-[#5D4037]">
          <i class="fa fa-times"></i>
        </button>
      </div>
      
      <div class="space-y-3">
        <div>
          <label class="block text-sm mb-1">邮箱地址</label>
          <input type="email" id="login-email" placeholder="请输入邮箱" class="w-full border border-[#FFEDCC] rounded-lg p-3 focus:outline-none focus:border-[#FB8C00]">
          <p id="email-error" class="text-xs text-red-500 mt-1 hidden">请输入有效的邮箱地址</p>
        </div>
        <div>
          <label class="block text-sm mb-1">密码</label>
          <input type="password" id="login-password" placeholder="请输入密码" class="w-full border border-[#FFEDCC] rounded-lg p-3 focus:outline-none focus:border-[#FB8C00]">
          <p id="password-error" class="text-xs text-red-500 mt-1 hidden">密码长度至少为6位</p>
        </div>
        <div class="flex justify-between items-center">
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="accent-[#FB8C00]">
            <span>记住我</span>
          </label>
          <a href="#" class="text-sm text-[#FB8C00] hover:underline">忘记密码？</a>
        </div>
        <button id="do-login" class="btn-primary w-full btn-laser">登录</button>
        <p class="text-center text-sm text-[#5D4037]/60">
          还没有账号？<button id="show-register" class="text-[#FB8C00] hover:underline">立即注册</button>
        </p>
      </div>
    </div>
  </div>

  <script>
    // 模拟的用户数据
    const mockUsers = [
      { id: 1, username: "星辰大海", avatar: "https://picsum.photos/id/64/100/100" },
      { id: 2, username: "安全第一", avatar: "https://picsum.photos/id/65/100/100" },
      { id: 3, username: "小编账号", avatar: "https://picsum.photos/id/22/100/100", isAdmin: true },
      { id: 4, username: "科幻迷", avatar: "https://picsum.photos/id/68/100/100" },
      { id: 5, username: "宇宙漫游者", avatar: "https://picsum.photos/id/61/100/100" }
    ];
    
    // 当前登录用户
    let currentUser = null;
    
    // 显示通知
    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      toastMessage.textContent = message;
      toast.classList.remove('opacity-0');
      toast.classList.add('opacity-100');
      
      setTimeout(() => {
        hideToast();
      }, 3000);
    }
    
    // 隐藏通知
    function hideToast() {
      const toast = document.getElementById('toast');
      toast.classList.remove('opacity-100');
      toast.classList.add('opacity-0');
    }
    
    // 移动端菜单切换
    document.getElementById('mobile-menu-btn').addEventListener('click', () => {
      const menu = document.getElementById('mobile-menu');
      menu.classList.toggle('hidden');
    });
    
    // 登录模态框控制
    document.getElementById('login-btn').addEventListener('click', () => {
      document.getElementById('login-modal').classList.remove('hidden');
    });
    
    document.getElementById('mobile-login-btn').addEventListener('click', () => {
      document.getElementById('login-modal').classList.remove('hidden');
      document.getElementById('mobile-menu').classList.add('hidden');
    });
    
    document.getElementById('close-login').addEventListener('click', () => {
      document.getElementById('login-modal').classList.add('hidden');
    });
    
    // 波纹效果
    document.querySelectorAll('.join-project, #vote-btn, #do-login').forEach(button => {
      button.addEventListener('click', function(e) {
        const rect = this.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const ripple = document.createElement('span');
        ripple.classList.add('ripple');
        ripple.style.left = x + 'px';
        ripple.style.top = y + 'px';
        
        this.appendChild(ripple);
        
        setTimeout(() => {
          ripple.remove();
        }, 600);
      });
    });
    
    // 登录功能
    document.getElementById('do-login').addEventListener('click', () => {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      // 验证邮箱格式
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        document.getElementById('email-error').classList.remove('hidden');
        return;
      } else {
        document.getElementById('email-error').classList.add('hidden');
      }
      
      // 验证密码长度
      if (password.length < 6) {
        document.getElementById('password-error').classList.remove('hidden');
        return;
      } else {
        document.getElementById('password-error').classList.add('hidden');
      }
      
      // 模拟登录成功
      document.getElementById('login-modal').classList.add('hidden');
      showToast('登录成功！');
      
      // 查找用户
      const user = mockUsers[Math.floor(Math.random() * mockUsers.length)];
      currentUser = user;
      
      // 更新界面显示登录状态
      document.getElementById('login-btn').classList.add('hidden');
      document.getElementById('user-info').classList.remove('hidden');
      document.getElementById('username-display').textContent = currentUser.username;
      document.getElementById('user-avatar').src = currentUser.avatar;
    });
    
    // 参与共创功能
    document.querySelectorAll('.join-project').forEach(button => {
      button.addEventListener('click', () => {
        const projectName = button.getAttribute('data-project');
        
        if (!currentUser) {
          showToast('请先登录再参与共创');
          document.getElementById('login-modal').classList.remove('hidden');
          return;
        }
        
        showToast(`已加入项目《${projectName}》，可以开始参与共创了！`);
        
        // 滚动到投票区域
        document.querySelector('section:nth-of-type(2)').scrollIntoView({
          behavior: 'smooth'
        });
      });
    });
    
    // 投票功能
    document.getElementById('vote-btn').addEventListener('click', () => {
      if (!currentUser) {
        showToast('请先登录再投票');
        document.getElementById('login-modal').classList.remove('hidden');
        return;
      }
      
      const selected = document.querySelector('input[name="plot-choice"]:checked');
      if (selected) {
        const choiceText = selected.parentElement.textContent.trim();
        showToast(`投票成功！你选择了：${choiceText}`);
      } else {
        showToast('请先选择一个剧情选项');
      }
    });
    
    // 注销功能
    function logout() {
      currentUser = null;
      showToast('已成功注销');
      
      // 更新界面显示
      document.getElementById('login-btn').classList.remove('hidden');
      document.getElementById('user-info').classList.add('hidden');
    }
    
    // 点击空白处关闭模态框
    document.getElementById('login-modal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('login-modal')) {
        document.getElementById('login-modal').classList.add('hidden');
      }
    });
    
    // 页面初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 模拟加载进度
      let progress = 0;
      const loadingInterval = setInterval(() => {
        progress += Math.floor(Math.random() * 10);
        if (progress >= 100) {
          progress = 100;
          clearInterval(loadingInterval);
        }
        document.getElementById('loading-bar').style.width = `${progress}%`;
      }, 100);
      
      // 页面加载完成后隐藏开机动画
      setTimeout(() => {
        document.getElementById('splash-screen').style.display = 'none';
      }, 1800);
    });
  </script>
</body>
</html>